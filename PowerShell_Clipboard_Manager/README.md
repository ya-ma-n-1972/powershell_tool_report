# PowerShell Clipboard Manager - 取扱説明書

## 概要

PowerShell Clipboard Managerは、Windows環境で動作するクリップボード履歴管理ツールです。  
Cliborライクな操作感で、クリップボード履歴の管理と定型文の登録・利用が可能です。

## 主な機能

- 📋 **クリップボード履歴管理** - 最大20件の履歴を自動保存
- 📝 **定型文機能** - 最大10件の定型文を登録・編集・管理
- ⌨️ **ホットキー対応** - Ctrl+Shift+Spaceで瞬時にアクセス（カスタマイズ可能）
- 💾 **データ永続化** - 履歴と定型文をJSON形式で保存
- 🖱️ **完全キーボード操作対応** - マウスなしで全機能を利用可能
- 📍 **タスクトレイ常駐** - 邪魔にならないバックグラウンド動作

## システム要件

| 項目 | 要件 |
|------|------|
| OS | Windows 10/11 |
| PowerShell | 5.1以上 |
| 実行環境 | PowerShell ISE推奨 |
| 管理者権限 | 不要 |
| 必要ファイル | Clipboard_Manager.ps1<br>Hotkey_Monitor.ps1 |

## インストールと起動

### セットアップ

1. 任意のフォルダに以下の2つのファイルを配置
   ```
   📁 任意のフォルダ
    ├── Clipboard_Manager.ps1
    └── Hotkey_Monitor.ps1
   ```

2. PowerShell ISEまたはPowerShellコンソールでClipboard_Manager.ps1を実行
   ```powershell
   .\Clipboard_Manager.ps1
   ```

### 起動確認

✅ タスクトレイにPowerShellアイコンが表示  
✅ コンソールに起動メッセージが表示  
✅ Hotkey_Monitor.ps1が自動起動（別プロセス）

## 使い方

### ウィンドウの表示

| 方法 | 操作 |
|------|------|
| ホットキー | `Ctrl + Shift + Space` |
| タスクトレイ | アイコンをシングルクリック |
| 右クリックメニュー | タスクトレイアイコン右クリック → 「表示」 |

### キーボード操作

| キー | 動作 |
|------|------|
| `Ctrl+Shift+Space` | ウィンドウをポップアップ表示 |
| `↑` `↓` | 項目の選択移動 |
| `Enter` | 選択項目をクリップボードに設定して格納 |
| `Tab` | 履歴と定型文の切り替え |
| `Esc` | ウィンドウを閉じる（タスクトレイに格納） |
| `メニューキー` | 右クリックメニューを表示 |

### クリップボード履歴機能

#### 基本動作
- テキストをコピーすると自動的に履歴に記録
- 最新20件を保持（古いものから自動削除）
- 重複する内容は自動的に最新位置に移動

#### 履歴の利用
1. 履歴リストから項目を選択（クリックまたは矢印キー）
2. Enterキーまたはクリックでクリップボードに設定
3. ウィンドウは自動的にタスクトレイに格納

#### 履歴の編集・削除
- **編集**: 履歴項目を右クリック → 「編集」
- **削除**: 履歴項目を右クリック → 「削除」
- **定型文へ追加**: 履歴項目を右クリック → 「定型文に追加」

### 定型文機能

#### 新規登録方法

**方法1: 直接入力**
1. 定型文エリアの空白部分を右クリック
2. 「新規登録」を選択
3. テキスト編集ダイアログで入力（改行対応）

**方法2: クリップボードから**
1. 定型文エリアの空白部分を右クリック
2. 「現在のクリップボードを登録」を選択

**方法3: 履歴から**
1. 履歴項目を右クリック
2. 「定型文に追加」を選択

#### 定型文の管理

| 操作 | 方法 |
|------|------|
| **編集** | 定型文を右クリック → 「編集」 |
| **削除** | 定型文を右クリック → 「削除」 |
| **順序変更（上）** | 定型文を右クリック → 「上へ移動」 |
| **順序変更（下）** | 定型文を右クリック → 「下へ移動」 |

### ホットキーのカスタマイズ

Hotkey_Monitor.ps1の23-67行目でホットキーを変更可能：

```powershell
# デフォルト設定
$HOTKEY_MODIFIERS = 0x0002 -bor 0x0004  # Ctrl+Shift
$HOTKEY_KEY = 0x20  # Space
$HOTKEY_DESCRIPTION = "Ctrl+Shift+Space"
```

詳細な設定例はファイル内のコメントを参照してください。

## データ管理

### 保存ファイル

`clipboard_data.json` - アプリケーションと同じフォルダに自動生成

### 保存内容
- 定型文（全データ）
- クリップボード履歴（設定により保存/非保存を選択可能）
- アプリケーション設定

### 保存先の変更

Clipboard_Manager.ps1の30行目付近で変更可能：
```powershell
# デフォルト（スクリプトと同じフォルダ）
$script:data_file_path = Join-Path $PSScriptRoot "clipboard_data.json"

# カスタムパスの例
# $script:data_file_path = "D:\MyData\clipboard_data.json"
```

## トラブルシューティング

### ホットキーが動作しない

**原因と対処法:**
1. **他のアプリケーションとの競合**
   - Hotkey_Monitor.ps1でホットキーを変更
   
2. **Hotkey_Monitor.ps1が起動していない**
   - 手動で個別に起動：
   ```powershell
   .\Hotkey_Monitor.ps1
   ```
   
3. **VDI環境での同期遅延**
   - SharePoint同期環境では手動起動が必要な場合があります

### タスクバーの点滅

初回起動時の正常な動作です。一度クリックすると以降は点滅しません。

### 改行が表示されない

リストボックスの仕様で最初の行のみ表示されますが、データは完全に保持されています。

### 文字化け

PowerShellのエンコーディング設定を確認してください。本ツールはUTF-8対応です。

## セキュリティ上の注意

⚠️ **パスワードや機密情報の取り扱い**
- クリップボード履歴にはコピーしたすべてのテキストが記録されます
- パスワードマネージャーからのコピーなどは履歴に残ります
- 必要に応じて履歴項目を個別に削除してください

## アンインストール

1. タスクトレイアイコンを右クリック → 「終了」
2. 以下のファイルを削除：
   - Clipboard_Manager.ps1
   - Hotkey_Monitor.ps1
   - clipboard_data.json

## 技術仕様

- **アーキテクチャ**: 2プロセス構成（メイン + ホットキー監視）
- **プロセス間通信**: 名前付きパイプ（PSClipboardPipe）
- **データ形式**: JSON（UTF-8エンコーディング）
- **監視間隔**: 500ms（変更可能）

## ライセンス

本ソフトウェアはフリーソフトウェアです。商用・非商用を問わず自由にご利用ください。

## バージョン

- **Version**: 2.0
- **Release Type**: 2プロセス版
- **PowerShell**: 5.1以上対応

---

*© 2024 PowerShell Clipboard Manager*
